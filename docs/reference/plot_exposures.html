<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Display sample exposures with bar, box, or violin plots — plot_exposures • musicatk</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Display sample exposures with bar, box, or violin plots — plot_exposures" />
<meta property="og:description" content="The distributions of mutational signatures can be viewed 
with barplots or box/violin plots. Barplots are most useful for viewing
the proportion of signatures within and across samples. The box/violin plots
are most useful for viewing the distributions of signatures with respect to 
sample annotations. Samples can be grouped using the group_by
parameter. For barplots, various methods of sorting samples from left
to right can be chosen using the sort_samples parameter." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">musicatk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/musicatk.html">General Workflow</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shiny UI Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/musicatk_help.html">Tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/campbio/musicatk/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Display sample exposures with bar, box, or violin plots</h1>
    <small class="dont-index">Source: <a href='https://github.com/campbio/musicatk/blob/master/R/plot_exposures.R'><code>R/plot_exposures.R</code></a></small>
    <div class="hidden name"><code>plot_exposures.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The distributions of mutational signatures can be viewed 
with barplots or box/violin plots. Barplots are most useful for viewing
the proportion of signatures within and across samples. The box/violin plots
are most useful for viewing the distributions of signatures with respect to 
sample annotations. Samples can be grouped using the <code>group_by</code>
parameter. For barplots, various methods of sorting samples from left
to right can be chosen using the <code>sort_samples</code> parameter.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_exposures</span><span class='op'>(</span>
  <span class='va'>result</span>,
  plot_type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bar"</span>, <span class='st'>"box"</span>, <span class='st'>"violin"</span><span class='op'>)</span>,
  proportional <span class='op'>=</span> <span class='cn'>FALSE</span>,
  group_by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"none"</span>, <span class='st'>"annotation"</span>, <span class='st'>"signature"</span><span class='op'>)</span>,
  color_by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"signature"</span>, <span class='st'>"annotation"</span><span class='op'>)</span>,
  annotation <span class='op'>=</span> <span class='cn'>NULL</span>,
  num_samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  sort_samples <span class='op'>=</span> <span class='st'>"total"</span>,
  threshold <span class='op'>=</span> <span class='cn'>NULL</span>,
  same_scale <span class='op'>=</span> <span class='cn'>FALSE</span>,
  add_points <span class='op'>=</span> <span class='cn'>FALSE</span>,
  point_size <span class='op'>=</span> <span class='fl'>2</span>,
  label_x_axis <span class='op'>=</span> <span class='cn'>FALSE</span>,
  legend <span class='op'>=</span> <span class='cn'>TRUE</span>,
  plotly <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>result</th>
      <td><p>A <code><a href='musica_result-class.html'>musica_result</a></code> object generated by
a mutational discovery or prediction tool.</p></td>
    </tr>
    <tr>
      <th>plot_type</th>
      <td><p>One of <code>"bar"</code>, <code>"box"</code>, or <code>"violin"</code>.
Default <code>"bar"</code>.</p></td>
    </tr>
    <tr>
      <th>proportional</th>
      <td><p>If <code>TRUE</code>, then the exposures will be normalized
to between 0 and 1 by dividing by the total number of counts for each sample.
Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>group_by</th>
      <td><p>Determines how to group samples into the subplots
(i.e. facets). One of <code>"none"</code>, <code>"signature"</code> or
<code>"annotation"</code>. If set to <code>"annotation"</code>,
then a sample annotation must be supplied via the 
<code>annotation</code> parameter. Default <code>"none"</code>.</p></td>
    </tr>
    <tr>
      <th>color_by</th>
      <td><p>Determines how to color the bars or box/violins. One of
<code>"signature"</code> or <code>"annotation"</code>. If set to <code>"annotation"</code>,
then a sample annotation must be supplied via the 
<code>annotation</code> parameter. Default <code>"signature"</code>.</p></td>
    </tr>
    <tr>
      <th>annotation</th>
      <td><p>Sample annotation used to group the subplots and/or
color the bars, boxes, or violins. Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>num_samples</th>
      <td><p>The top number of sorted samples to display. If
<code>NULL</code>, then all samples will be displayed. If <code>group_by</code> is set,
then the top samples will be shown within each group. Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>sort_samples</th>
      <td><p>This is used to change how samples are sorted in
the barplot from left to right. If set to <code>"total"</code>, then samples
will be sorted from those with the highest number of mutation counts to the
lowest (regardless of how the parameter <code>"proportional"</code> is set).
If set to <code>"name"</code>, then samples are sorted by their name with the
<code><a href='https://rdrr.io/pkg/gtools/man/mixedsort.html'>mixedsort</a></code> function. If set to 
one or more signature names (e.g. <code>"Signature1"</code>), then samples will
be sorted from those with the highest level of that signature to the lowest.
If multiple signatures are supplied then, samples will be sorted by each
signature sequentially. Default <code>"total"</code>.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Exposures less than this threshold will be set to 0.
This is most useful when more than one signature is supplied to 
<code>sort_samples</code> as samples that are set to zero for the first exposure
will then be sorted by the levels of the second exposure.
Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>same_scale</th>
      <td><p>If <code>TRUE</code>, then all subplots will have the 
same scale. Only used when <code>group_by</code> is set. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>add_points</th>
      <td><p>If <code>TRUE</code>, then points for individual sample 
exposures will be plotted on top of the violin/box plots. Only used when
<code>plot_type</code> is set to <code>"violin"</code> or <code>"box"</code>. 
Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>point_size</th>
      <td><p>Size of the points to be plotted on top of the
violin/box plots. Only used when <code>plot_type</code> is set to <code>"violin"</code>
or <code>"box"</code> and <code>add_points</code> is set to <code>TRUE</code>. 
Default <code>2</code>.</p></td>
    </tr>
    <tr>
      <th>label_x_axis</th>
      <td><p>If <code>TRUE</code>, x-axis labels will be displayed at
the bottom of the plot. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>If <code>TRUE</code>, the legend will be displayed.
Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>plotly</th>
      <td><p>If <code>TRUE</code>, the the plot will be made interactive
using <code><a href='https://docs.ropensci.org/plotly/reference/plotly.html'>plotly</a></code>. Default <code>FALSE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Generates a ggplot or plotly object</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>res_annot</span><span class='op'>)</span>
<span class='fu'>plot_exposures</span><span class='op'>(</span><span class='va'>res_annot</span>, plot_type <span class='op'>=</span> <span class='st'>"bar"</span>, annotation <span class='op'>=</span> <span class='st'>"Tumor_Subtypes"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_exposures-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Aaron Chevalier, Joshua D. Campbell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


