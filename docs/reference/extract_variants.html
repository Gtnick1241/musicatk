<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract variants from mutliple objects — extract_variants • musicatk</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extract variants from mutliple objects — extract_variants" />
<meta property="og:description" content="Chooses the correct function to extract variants from input based on
the class of the object or the file extension. Different types of objects
can be mixed within the list. For example, the list can include VCF files
and maf objects. Certain parameters such as id and rename
only apply to VCF objects or files and need to be individually specified
for each VCF. Therefore, these parameters should be suppied as a vector
that is the same length as the number of inputs. If other types of
objects are in the input list, then the value of id and rename
will be ignored for these items." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">musicatk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/musicatk.html">General Workflow</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Shiny UI Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/musicatk_help.html">Tutorial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/campbio/musicatk/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract variants from mutliple objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/campbio/musicatk/blob/master/R/load_data.R'><code>R/load_data.R</code></a></small>
    <div class="hidden name"><code>extract_variants.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Chooses the correct function to extract variants from input based on
the class of the object or the file extension. Different types of objects
can be mixed within the list. For example, the list can include VCF files
and maf objects. Certain parameters such as <code>id</code> and <code>rename</code>
only apply to VCF objects or files and need to be individually specified
for each VCF. Therefore, these parameters should be suppied as a vector
that is the same length as the number of inputs. If other types of
objects are in the input list, then the value of <code>id</code> and <code>rename</code>
will be ignored for these items.</p>
    </div>

    <pre class="usage"><span class='fu'>extract_variants</span><span class='op'>(</span>
  <span class='va'>inputs</span>,
  id <span class='op'>=</span> <span class='cn'>NULL</span>,
  rename <span class='op'>=</span> <span class='cn'>NULL</span>,
  sample_field <span class='op'>=</span> <span class='cn'>NULL</span>,
  filename_as_id <span class='op'>=</span> <span class='cn'>FALSE</span>,
  strip_extension <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".vcf"</span>, <span class='st'>".vcf.gz"</span>, <span class='st'>".gz"</span><span class='op'>)</span>,
  filter <span class='op'>=</span> <span class='cn'>TRUE</span>,
  multiallele <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"expand"</span>, <span class='st'>"exclude"</span><span class='op'>)</span>,
  fix_vcf_errors <span class='op'>=</span> <span class='cn'>TRUE</span>,
  extra_fields <span class='op'>=</span> <span class='cn'>NULL</span>,
  chromosome_col <span class='op'>=</span> <span class='st'>"chr"</span>,
  start_col <span class='op'>=</span> <span class='st'>"start"</span>,
  end_col <span class='op'>=</span> <span class='st'>"end"</span>,
  ref_col <span class='op'>=</span> <span class='st'>"ref"</span>,
  alt_col <span class='op'>=</span> <span class='st'>"alt"</span>,
  sample_col <span class='op'>=</span> <span class='st'>"sample"</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inputs</th>
      <td><p>A vector or list of objects or file names. Objects can be
CollapsedVCF, ExpandedVCF, MAF,
an object that inherits from <code>matrix</code> or <code>data.frame</code>, or
character strings that denote the path to a vcf or maf file.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>A character vector the same length as <code>inputs</code> denoting
the sample to extract from a vcf.
See <code><a href='extract_variants_from_vcf.html'>extract_variants_from_vcf</a></code> for more details.
Only used if the input is a vcf object or file. Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>rename</th>
      <td><p>A character vector the same length as <code>inputs</code> denoting
what the same will be renamed to.
See <code><a href='extract_variants_from_vcf.html'>extract_variants_from_vcf</a></code> for more details.
Only used if the input is a vcf object or file. Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>sample_field</th>
      <td><p>Some algoriths will save the name of the
sample in the ##SAMPLE portion of header in the VCF.
See <code><a href='extract_variants_from_vcf.html'>extract_variants_from_vcf</a></code> for more details.
Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>filename_as_id</th>
      <td><p>If set to <code>TRUE</code>, the file name will be used
as the sample name.
See <code><a href='extract_variants_from_vcf_file.html'>extract_variants_from_vcf_file</a></code> for more details.
Only used if the input is a vcf file. Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>strip_extension</th>
      <td><p>Only used if <code>filename_as_id</code> is set to
<code>TRUE</code>. If set to <code>TRUE</code>, the file extention will be stripped
from the filename before setting the sample name.
See <code><a href='extract_variants_from_vcf_file.html'>extract_variants_from_vcf_file</a></code> for more details.
Only used if the input is a vcf file.
Default <code><a href='https://rdrr.io/r/base/c.html'>c(".vcf",".vcf.gz",".gz")</a></code></p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>Exclude variants that do not have a <code>PASS</code> in the
<code>FILTER</code> column of VCF inputs.</p></td>
    </tr>
    <tr>
      <th>multiallele</th>
      <td><p>Multialleles are when multiple alternative variants
are listed in the same row in the vcf.
See <code><a href='extract_variants_from_vcf.html'>extract_variants_from_vcf</a></code> for more details.
Only used if the input is a vcf object or file. Default <code>"expand"</code>.</p></td>
    </tr>
    <tr>
      <th>fix_vcf_errors</th>
      <td><p>Attempt to automatically fix VCF file
formatting errors.
See <code><a href='extract_variants_from_vcf_file.html'>extract_variants_from_vcf_file</a></code> for more details.
Only used if the input is a vcf file. Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>extra_fields</th>
      <td><p>Optionally extract additional fields from all input
objects. Default <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>chromosome_col</th>
      <td><p>The name of the column that contains the chromosome
reference for each variant. Only used if the input is a matrix or data.frame.
Default <code>"Chromosome"</code>.</p></td>
    </tr>
    <tr>
      <th>start_col</th>
      <td><p>The name of the column that contains the start
position for each variant. Only used if the input is a matrix or data.frame.
Default <code>"Start_Position"</code>.</p></td>
    </tr>
    <tr>
      <th>end_col</th>
      <td><p>The name of the column that contains the end
position for each variant. Only used if the input is a matrix or data.frame.
Default <code>"End_Position"</code>.</p></td>
    </tr>
    <tr>
      <th>ref_col</th>
      <td><p>The name of the column that contains the reference
base(s) for each variant. Only used if the input is a matrix or data.frame.
Default <code>"Tumor_Seq_Allele1"</code>.</p></td>
    </tr>
    <tr>
      <th>alt_col</th>
      <td><p>The name of the column that contains the alternative
base(s) for each variant. Only used if the input is a matrix or data.frame.
Default <code>"Tumor_Seq_Allele2"</code>.</p></td>
    </tr>
    <tr>
      <th>sample_col</th>
      <td><p>The name of the column that contains the sample
id for each variant. Only used if the input is a matrix or data.frame.
Default <code>"sample"</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show progress of variant extraction. Default <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a data.table of variants from a vcf</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Get loations of two vcf files and a maf file</span>
<span class='va'>luad_vcf_file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"public_LUAD_TCGA-97-7938.vcf"</span>,
package <span class='op'>=</span> <span class='st'>"musicatk"</span><span class='op'>)</span>
<span class='va'>lusc_maf_file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"public_TCGA.LUSC.maf"</span>,
package <span class='op'>=</span> <span class='st'>"musicatk"</span><span class='op'>)</span>
<span class='va'>melanoma_vcfs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, package <span class='op'>=</span> <span class='st'>"musicatk"</span><span class='op'>)</span>,
  pattern <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/utils/glob2rx.html'>glob2rx</a></span><span class='op'>(</span><span class='st'>"*SKCM*vcf"</span><span class='op'>)</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># Read all files in at once</span>
<span class='va'>inputs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>luad_vcf_file</span>, <span class='va'>melanoma_vcfs</span>, <span class='va'>lusc_maf_file</span><span class='op'>)</span>
<span class='va'>variants</span> <span class='op'>&lt;-</span> <span class='fu'>extract_variants</span><span class='op'>(</span>inputs <span class='op'>=</span> <span class='va'>inputs</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%</div><div class='output co'>#&gt; <span class='message'>Extracted 1 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_LUAD_TCGA-97-7938.vcf</span></div><div class='output co'>#&gt;   |                                                                              |============================                                          |  40%</div><div class='output co'>#&gt; <span class='message'>Extracted 2 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_SKCM_TCGA-EE-A3J5-06A-11D-A20D-08.vcf</span></div><div class='output co'>#&gt;   |                                                                              |==========================================                            |  60%</div><div class='output co'>#&gt; <span class='message'>Extracted 3 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_SKCM_TCGA-ER-A197-06A-32D-A197-08.vcf</span></div><div class='output co'>#&gt;   |                                                                              |========================================================              |  80%</div><div class='output co'>#&gt; <span class='message'>Extracted 4 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_SKCM_TCGA-ER-A19O-06A-11D-A197-08.vcf</span></div><div class='output co'>#&gt;   |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>Extracted 5 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_TCGA.LUSC.maf</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>variants</span><span class='op'>$</span><span class='va'>sample</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; TCGA-97-7938-01A-11D-2167-08 TCGA-EE-A3J5-06A-11D-A20D-08 
#&gt;                          121                          123 
#&gt; TCGA-ER-A197-06A-32D-A197-08 TCGA-ER-A19O-06A-11D-A197-08 
#&gt;                           13                           52 
#&gt; TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 
#&gt;                          199                          283 
#&gt; TCGA-94-7557-01A-11D-2122-08 
#&gt;                          120 </div><div class='input'>
<span class='co'># Run again but renaming samples in first four vcfs</span>
<span class='va'>new_name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Sample"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span>, <span class='cn'>NA</span><span class='op'>)</span>
<span class='va'>variants</span> <span class='op'>&lt;-</span> <span class='fu'>extract_variants</span><span class='op'>(</span>inputs <span class='op'>=</span> <span class='va'>inputs</span>, rename <span class='op'>=</span> <span class='va'>new_name</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |==============                                                        |  20%</div><div class='output co'>#&gt; <span class='message'>Extracted 1 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_LUAD_TCGA-97-7938.vcf</span></div><div class='output co'>#&gt;   |                                                                              |============================                                          |  40%</div><div class='output co'>#&gt; <span class='message'>Extracted 2 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_SKCM_TCGA-EE-A3J5-06A-11D-A20D-08.vcf</span></div><div class='output co'>#&gt;   |                                                                              |==========================================                            |  60%</div><div class='output co'>#&gt; <span class='message'>Extracted 3 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_SKCM_TCGA-ER-A197-06A-32D-A197-08.vcf</span></div><div class='output co'>#&gt;   |                                                                              |========================================================              |  80%</div><div class='output co'>#&gt; <span class='message'>Extracted 4 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_SKCM_TCGA-ER-A19O-06A-11D-A197-08.vcf</span></div><div class='output co'>#&gt;   |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>Extracted 5 out of 5 inputs: /private/var/folders/x6/0v9y3yds0n30r75qkpj7yqqm0000gn/T/RtmpjczcGj/temp_libpath17b9fa1d168e/musicatk/extdata/public_TCGA.LUSC.maf</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>variants</span><span class='op'>$</span><span class='va'>sample</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;                      Sample1                      Sample2 
#&gt;                          121                          123 
#&gt;                      Sample3                      Sample4 
#&gt;                           13                           52 
#&gt; TCGA-56-7582-01A-11D-2042-08 TCGA-77-7335-01A-11D-2042-08 
#&gt;                          199                          283 
#&gt; TCGA-94-7557-01A-11D-2122-08 
#&gt;                          120 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Aaron Chevalier, Joshua D. Campbell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


